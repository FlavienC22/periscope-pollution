
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>A-Frame Particle System Component Example</title>
    <meta name="description" content="Hello, World!">
    <script src="https://aframe.io/releases/0.4.0/aframe.min.js"></script>
    <script src="https://rawgit.com/IdeaSpaceVR/aframe-particle-system-component/master/dist/aframe-particle-system-component.min.js"></script>
    <script src="https://rawgit.com/squarefeet/ShaderParticleEngine/master/build/SPE.js"></script>
    <script src="https://unpkg.com/aframe-animation-component/dist/aframe-animation-component.min.js"></script>
  </head>
  <body>
    <a-scene>
    <!-- <a-scene fog="type: linear; color: #AAA; far : 1; near : 30" animation__fog="property: fog.near; to: 500; dur: 2000"> -->

      <a-assets>
        <img id="city" crossorigin="anonymous" src="img/360-cottage-interior-render-green.png" >
        <img id="viseur" crossorigin="anonymous" src="./img/viseur-01.png">
      </a-assets>

      <a-entity id="pollution" pollution="count:1000;multiplier:1"></a-entity>

      <a-entity id="link1" layout="type: line; margin: 1.5" position="0 -1 -4">
        
      </a-entity>

      <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js'></script>
      <script src='../js/pollution.js'></script>

      <script type="text/javascript">












        // make the pollution disappear
        function fadeOut() {
          var multiplier = 1;
          var interval = setInterval(function(){
            var el = document.getElementById("pollution")
            multiplier = multiplier - 0.1;
            d3.select("#pollution")
              .attr("pollution", function(d){
                return { multiplier : multiplier}
              })
            if(multiplier < 0) clearInterval(interval);
          }, 200);
        }

        // move particle field X/Y/Z coordinates
        function changePosition() {
          return setInterval(function(){

            var pos = d3.select("#pollution").attr("position")

            d3.select("#pollution")
            .transition()
            .duration(1000)
            .attrTween("position", function(d) {
              var prev = pos.x +" "+ pos.y +" " +pos.z;
              var next = pos.x +" "+ pos.y +" " +(pos.z + 10);
              return d3.interpolate(prev, next);
            });

          }, 1000);
      }

      </script>
      <!-- <a-entity position="0 2.25 -15" particle-system="preset: dust; particleCount: 10000; texture: ./img/pm25.png; opacity: 1;"></a-entity> -->

      <!-- <a-entity position="0 2.25 -15" particle-system="preset: dust; particleCount: 5000; texture: ./img/star2.png; color: #0000FF,#00FF00,#FF0000"></a-entity> -->

->

      <a-sky id="image-360" radius="100" src="#city"></a-sky>

    </a-scene>
  </body>
</html>
